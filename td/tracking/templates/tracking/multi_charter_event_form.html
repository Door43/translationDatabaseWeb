{% extends "site_base.html" %}

{% load i18n %}
{% load bootstrap %}

{% block head_title %}Translation Project Event | New{% endblock head_title %}

{% block extra_style %}
	<style>
		form .form-group::after {
			content: '';
			display: block;
			clear: both;
		}
		.control-label-sub {
			font-size: 90%;
			font-weight: 300;
			color: #444;
		}
		.full-width {
			width: 100%;
		}
		.half-width {
			width: 50%;
		}
		.quarter-width {
			width: 25%;
		}

		.date-input {
			width: calc(33.33% - 3px);
			display: inline-block;
			float: left;
			margin-right: 3px;
		}
		.date-input:last-child {
			width: 33.33%;
			margin-right: 0;
		}

		.inline div, .inline label {
			display: inline;
			float: left;
		}
		.inline-input {
			margin-top: 0.1rem;
		}
		.inline input[type="checkbox"].form-control {
			width: 20px;
			height: 20px;
			margin: 7px auto 0 auto;
		}
		.facilitator-text {
			width: calc(100% - 140px);
		}
		.facilitator-checkboxes {
			width: 140px;
		}
		.material-text {
			width: calc(100% - 70px);
		}
		.material-checkboxes {
			width: 70px;
		}
		.btn-add {
			margin-left: 1rem;
		}

		input[type="checkbox"] {
			width: auto;
			margin: 0 1rem;
		}
		ul {
			list-style: none;
			padding-left: 0;
		}
		ul > li > label {
			font-weight: lighter;
		}
	</style>
{% endblock extra_style %}	

{% block body %}

	<!-- Modal -->
	<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="charterModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
			</div>
		</div>
	</div>
	<!-- Modal end -->

	<div class="row">
		<div class="col-md-6">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h2 class="panel-title">Multiple Charter Event Form | Step <span>{{ wizard.steps.step1 }}</span> of <span>{{ wizard.steps.count }}</span></h2>
				</div>
				<div class="panel-body">
					<form action="" method="POST" class="form">
						{% csrf_token %}
						{{ wizard.management_form }}
						
						<div id="charter-list" class="charter-list">
							{{ wizard.form | bootstrap }}
						</div>

						<a href="" class="add-charter-link" style="display: block; margin: 1rem 0;">Add</a>

						<p style="clear: both; padding: 1rem 0; font-weight: lighter;">
							Can't find your charter? It probably has not been created. Why not 
							<a href="{% url 'tracking:new_charter_modal' %}" data-toggle="modal" data-target="#modal" title="New Charter" data-tooltip>Create one</a>
							right now and try again?
						</p>
						
						<input type="hidden" name="language-count" value="1" />
						{% for hidden in form.hidden_fields %}{{ hidden }}{% endfor %}

						<button type="submit" class="btn btn-primary pull-right">
							{% if form.errors %}Try again{% else %}Add Charter{% endif %}
						</button>
					</form>

				</div>
			</div>
		</div>
	</div>

{% endblock body%}

{% block custom_bottom_script %}
	<script src="http://malsup.github.com/jquery.form.js"></script>
	<script>
		$(document).ready(function() {
			var number = 0;

			$('.add-charter-link').on('click', function(e) {
				e.preventDefault();
				addCharter();
			});

			$('.charter-list').on('click', '.remove-charter-link', function(e) {
				e.preventDefault();
				$(this.parentElement).detach();
			});

			$('.language-selector').languageSelector();

			function addCharter() {
				number += 1;
				var el = '<div class=" " style="display: flex; align-items: center;">' +
				         '   <input class="language-selector form-control" data-source-url="/tracking/ac/charters" id="id_0-language_' + number + '" maxlength="200" name="0-language_0" type="text">' +
				         '   <a href="" class="remove-charter-link" style="margin-left: 1rem;">Remove</a>'
						 '</div>';
				$('#charter-list .form-group').append(el);
				$('#id_0-language_' + number).languageSelector();
			}
		});

	</script>
{% endblock custom_bottom_script %}